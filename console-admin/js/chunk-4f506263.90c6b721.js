(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f506263"],{"16ba":function(t,e,n){},"32e5":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{attrs:{id:"tab-card"}},[n("p",{attrs:{slot:"title"},slot:"title"},[t._v("调度明细")]),n("Row",[n("Form",{attrs:{inline:"","label-width":100}},[n("FormItem",{attrs:{label:"任务名称"}},[n("Input",{attrs:{placeholder:"请输入任务名称"},model:{value:t.taskName,callback:function(e){t.taskName=e},expression:"taskName"}})],1),n("FormItem",{staticStyle:{width:"250px"},attrs:{label:"后台可用分组"}},[n("Select",{attrs:{placeholder:"请选择后台可用分组"},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},t._l(t.groupList,(function(e){return n("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.groupName))])})),1)],1),n("FormItem",{staticStyle:{width:"300px"},attrs:{label:"调度开始时间"}},[n("DatePicker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择调度开始时间"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}})],1),n("FormItem",{staticStyle:{width:"3000px"},attrs:{label:"调度结束时间"}},[n("DatePicker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择调度结束时间"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1),n("FormItem",[n("Button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")])],1)],1)],1),n("Row",{staticClass:"margin-top-20"},[n("Table",{attrs:{border:"",columns:t.columns,data:t.data}})],1),n("Row",{staticClass:"margin-top-20"},[n("Page",{attrs:{"page-size-opts":t.page.pageSiezs,"page-size":t.page.pageSize,total:t.page.total,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":t.toPageNo,"on-page-size-change":t.changePageSize}})],1)],1)},r=[],s=(n("6d57"),n("06a2"),n("88c5"),n("7e1e")),o={name:"task-list",data:function(){var t=this;return{commandId:"",taskName:"",commandType:"",scheduleState:"",targetHost:[],timerTaskList:[],groupList:[],groupId:"",startTime:null,endTime:null,traceId:null,toDoTaskMap:new Map,isClean:!1,columns:[{title:"指令ID",key:"commandId",align:"center",width:80},{title:"名称",key:"taskName",align:"center"},{title:"指令",key:"commandType",align:"center",width:80,render:function(t,e){return t("strong",Object(s["p"])(e.row.commandType))}},{title:"状态",key:"scheduleState",align:"center",width:90,render:function(t,e){return t("strong",Object(s["o"])(e.row.scheduleState))}},{title:"目标机器",key:"targetHost",align:"center",minWidth:80},{title:"发起时间",key:"publishTime",align:"center",minWidth:80},{title:"实际发起",key:"startTime",align:"center",minWidth:80},{title:"实际结束",key:"endTime",align:"center",minWidth:80},{title:"追踪ID",key:"traceId",align:"center",minWidth:80},{title:"进度",align:"center",width:200,render:function(t,e){if("SCHEDULE"==e.row.commandType&&"INIT"!=e.row.scheduleState){e.index;"RUN"==e.row.scheduleState&&e.row.commandType;var n=e.row.success?e.row.success:0,a=e.row.fail?e.row.fail:0,r=e.row.total?e.row.total:0,s=0===r?100:(n+a)/r*100,o=t("i-progress",{props:{percent:100===s?s-.01:s,status:"wrong",hideInfo:!0,successPercent:0===r?.01:n/r*100}});return t("Tooltip",{props:{content:"总数: "+r+"; 成功:"+n+"; 失败:"+a,placement:"top",theme:"light"},style:{width:"100%"}},[o])}}},{title:"操作",width:120,align:"center",render:function(e,n){return e("div",[e("Button",{props:{type:"warning",size:"small"},style:{marginLeft:"10px",display:"SCHEDULE"==n.row.commandType&&"INIT"==n.row.scheduleState?"inline-block":"none"},on:{click:function(){Object(s["s"])({commandId:n.row.commandId}).then((function(e){"200"===e.data.code?(t.$Message.success("删除调度成功"),t.taskLogList()):t.$Message.error("删除调度失败!"+e.data.msg)}))}}},"删除"),e("Button",{props:{type:"warning",size:"small"},style:{marginLeft:"10px",display:"SCHEDULE"==n.row.commandType&&"RUN"==n.row.scheduleState?"inline-block":"none"},on:{click:function(){Object(s["q"])({commandId:n.row.commandId}).then((function(e){"200"===e.data.code?(t.$Message.success("终止成功"),t.taskLogList()):t.$Message.error("终止失败!"+e.data.msg)}))}}},"终止"),e("Button",{props:{type:"info",size:"small"},style:{marginLeft:"10px",display:"FINISH"!=n.row.scheduleState&&"ABORT"!=n.row.scheduleState||"SCHEDULE"!=n.row.commandType?"none":"inline-block"},on:{click:function(){Object(s["r"])({commandId:n.row.commandId}).then((function(e){"200"===e.data.code?(t.$Message.success("复制成功"),t.taskLogList()):t.$Message.error("复制失败!"+e.data.msg)}))}}},"复制")])}}],data:[],page:{pageNo:1,pageSize:10,total:0,pageSizes:[10,20,50]}}},methods:{search:function(){for(var t=0;t<this.timerTaskList.length;t++)console.log("timeid "+this.timerTaskList[t]),window.clearTimeout(this.timerTaskList[t]);this.timerTaskList=new Array,this.taskLogList()},toPageNo:function(t){this.page.pageNo=t,this.taskLogList()},changePageSize:function(t){this.page.pageSize=t,this.taskLogList()},taskLogList:function(){var t=this,e={pageNo:this.page.pageNo,pageSize:this.page.pageSize,groupId:this.groupId,taskName:this.taskName,startTime:this.startTime,endTime:this.endTime};Object(s["h"])(e).then((function(e){"200"===e.data.code?(t.data=e.data.data,t.$forceUpdate(),t.page.total=e.data.totalNum):t.$Message.error(e.data.msg)}))},getGroupList:function(){var t=this;Object(s["g"])({pageNo:1,pageSize:9999}).then((function(e){"200"===e.data.code&&(t.groupList=e.data.data)}))},startProcess:function(){var t=this;if(!(this.timerTaskList.length>0)){var e=setTimeout((function(){t.taskLogList(),t.timerTaskList=[]}),3e3);this.timerTaskList.push(e)}}},mounted:function(){this.taskLogList(),this.getGroupList()}},i=o,u=(n("78d8"),n("4023")),c=Object(u["a"])(i,a,r,!1,null,null,null);e["default"]=c.exports},"78d8":function(t,e,n){"use strict";var a=n("16ba"),r=n.n(a);r.a},"7e1e":function(t,e,n){"use strict";n.d(e,"p",(function(){return r})),n.d(e,"o",(function(){return s})),n.d(e,"i",(function(){return o})),n.d(e,"n",(function(){return i})),n.d(e,"c",(function(){return u})),n.d(e,"f",(function(){return c})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return l})),n.d(e,"h",(function(){return m})),n.d(e,"e",(function(){return p})),n.d(e,"k",(function(){return g})),n.d(e,"m",(function(){return h})),n.d(e,"l",(function(){return f})),n.d(e,"d",(function(){return k})),n.d(e,"j",(function(){return w})),n.d(e,"a",(function(){return y})),n.d(e,"r",(function(){return L})),n.d(e,"q",(function(){return T})),n.d(e,"s",(function(){return I}));var a=n("66df"),r=function(t){switch(t){case"SCHEDULE":return"调度";case"SCHEDULE_STOP":return"终止"}return t},s=function(t){switch(t){case"INIT":return"待下发";case"PUBLISHING":return"下发中";case"PUBLISH_FAIL":return"下发失败";case"RUN":return"执行中";case"PAUSE":return"暂停";case"STOPING":return"终止中";case"ABORT":return"终止";case"FINISH":return"完成";case"DELETED":return"已取消"}return t},o=function(t){return a["a"].request({url:"/user/login",params:t,method:"post"})},i=function(t){return a["a"].request({url:"/schedule/immediate",data:t,method:"post"})},u=function(t){return a["a"].request({url:"/schedule/cleanRunningLock",params:t,method:"post"})},c=function(t){return a["a"].request({url:"/task/list",params:t,method:"get"})},d=function(t){return a["a"].request({url:"/task/add",data:t,method:"post"})},l=function(t){return a["a"].request({url:"/group/list",params:t,method:"get"})},m=function(t){return a["a"].request({url:"/command/list",params:t,method:"get"})},p=function(t){return a["a"].request({url:"/task/delete",data:t,method:"post"})},g=function(t){return a["a"].request({url:"/task/modify",data:t,method:"post"})},h=function(t){return a["a"].request({url:"/schedule/resume",data:t,method:"post"})},f=function(t){return a["a"].request({url:"/schedule/pause",data:t,method:"post"})},k=function(t){return a["a"].request({url:"/group/delete",data:t,method:"post"})},w=function(t){return a["a"].request({url:"/group/modify",data:t,method:"post"})},y=function(t){return a["a"].request({url:"/group/add",data:t,method:"post"})},L=function(t){return a["a"].request({url:"/command/taskCopy",data:t,method:"post"})},T=function(t){return a["a"].request({url:"/command/abort",data:t,method:"post"})},I=function(t){return a["a"].request({url:"/command/delete",data:t,method:"post"})}},"88c5":function(t,e,n){"use strict";var a=n("6179"),r=n("5a88"),s="Map";t.exports=n("fea3")(s,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=a.getEntry(r(this,s),t);return e&&e.v},set:function(t,e){return a.def(r(this,s),0===t?0:t,e)}},a,!0)}}]);